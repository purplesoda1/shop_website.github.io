<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Магазин сувениров</title>
    <style>
        @font-face {
            font-family: 'Mazzard H medium';
            src: url('MazzardH-Medium.eot');
            src: local('Mazzard H Medium'), local('MazzardH-Medium'),
                url('/fonts/Mazzard/MazzardH-Medium.woff') format('woff'),
                url('/fonts/Mazzard/MazzardH-Medium.woff2') format('woff2');
            font-weight: 500;
            font-style: normal;
        }

        @font-face {
            font-family: 'Mazzard H semibold';
            src: url('MazzardH-SemiBold.eot');
            src: local('Mazzard H SemiBold'), local('MazzardH-SemiBold'),
                url('/fonts/Mazzard/MazzardH-SemiBold.woff2') format('woff2'),
                url('/fonts/Mazzard/MazzardH-SemiBold.woff') format('woff');
            font-weight: 600;
            font-style: normal;
        }

        @font-face {
            font-family: 'Mazzard H regular';
            src: url('MazzardH-Regular.eot');
            src: local('Mazzard H Regular'), local('MazzardH-Regular'),
                url('/fonts/Mazzard/MazzardH-SemiBold.woff2') format('woff2'),
                url('/fonts/Mazzard/MazzardH-Regular.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Mazzard L light';
            src: url('MazzardL-Light.eot');
            src: local('Mazzard L Light'), local('MazzardL-Light'),
                url('/fonts/Mazzard/MazzardL-Light.woff2') format('woff2'),
                url('/fonts/Mazzard/MazzardL-Light.woff') format('woff');
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: 'TT Travels regular';
            src: local('TT Travels Regular'), local('TT-Travels-Regular'),
                url('/fonts/TTTravels-Regular/TTTravels-Regular.woff2') format('woff2'),
                url('/fonts/TTTravels-Regular/TTTravels-Regular.woff') format('woff');
            font-weight: 400;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Mazzard L light", sans-serif;
            line-height: 1.6;   
            padding-top: 80px;
            background: black;
            color: white;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            max-width: 1600px;
            margin: 0 auto 40px;
        }

        @media (max-width: 1024px) {
            .product-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
                padding: 20px 15px;
            }
        }

        @media (max-width: 375px) {
            .product-grid {
                grid-template-columns: 1fr;
            }
        }

        .product {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-height: 450px; 
            display: flex;
            flex-direction: column;
            padding: 20px;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .product-info {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin: 15px 0;
        }

        .product p {
            font-family: "Mazzard H medium";
            font-size: 16px;
            color: black;
            text-align: center;
            margin: 8px 0;
            line-height: 1.4;
        }

        .product p#price {
            font-family: "TT Travels regular";
            font-size: 15px;
        }

        button.show-more {
            background: #F5691E;
            color: white;
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            font-size: 24px;
            margin: 10px auto;
            display: block;
            border-radius: 5px;
            width: 80%;
            font-family: "Mazzard H semibold";
            font-size: 16px;
            transition: all 0.3s ease;
        }

        button.show-more:hover {
            background: #d35918;
        }

        .cart-wrapper {
            background: #F5691E;
            border-radius: 17.5px;
            height: 35px;
            width: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            right: 0;
            margin-top: 20px;
            margin-right: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cart-wrapper:hover {
            background: #d35918;
            transform: scale(1.05);
        }

        .cart-wrapper img#cart {
            height: 15px;
            margin-top: 0;
        }

        .product img, img#modalImage {
            height: 240px;
            margin-top: 30px; 
        }

        .product:hover {
            scale: 1.02;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .cta-button {
            background: #F5691E;
            color: white;
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            font-size: 24px;
            margin: 20px auto;
            display: block;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-radius: 2px;
            width: 100%;
        }

        .cta-button:hover {
            background: #d35918;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(235, 152, 74, 0.3);
        }

        .cta-button:active {
            transform: translateY(0);
            transition-duration: 0.1s;
        }

        .hero .about_company, .specials, .contacts {
            max-width: 1800px;
            margin: 0 auto;
            padding: 60px 20px;
            text-align: center;
        }

        .catalog {
            margin: 0 auto;
            background: white;
            color: black;
            width: 100%;
            text-align: center;
            padding-top: 20px;
            border: 1px rgba(0, 0, 0, 0) solid;
        }

        .catalog h2 {
            font-family: "Mazzard H semibold";
            font-size: 43px;
            margin-bottom: 40px;
        }

        header {
            position: fixed;
            justify-self: center;
            top: 0;
            width: 100%;
            height: 80px;
            background: black;
            z-index: 1000;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 0; 
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        header ul {
            display: flex;
            justify-content: center;
            gap: 90px;
            list-style: none;
            margin: 0;
            padding: 0 20px;
            font-family: "Mazzard L light";
            font-size: 18px;
            align-items: center;
            flex-wrap: wrap;
        }

        header ul li a {
            color: white;
            text-decoration: none;    
        }

        img.cart {
            height: 35px;
            margin-top: 3px;
        }

        .hero {
            display: flex;
            gap: 20px;
            max-width: 1700px;
            margin: 0 auto;
            padding: 60px 20px;
            align-items: flex-start;
            position: relative;
            max-height: 740px;
        }

        img.clocks {
            height: 680px;
            margin-left: 220px;    
        }

        img.logo1 {
            height: 66px;
            margin-top: 150px;
            margin-left: 120px;
        }

        img.logo2 {
            height: 47px;   
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-top: 250px;
            margin-left: -745px;
        }

        .hero .p1 {
            font-family: "Mazzard L light"; 
            font-size: 33px;
            margin-top: 360px;
            margin-left: -750px;
            width: 730px;
            white-space: nowrap;
        }

        .hero .p2 {
            font-family: "Mazzard L light"; 
            font-size: 33px;
            margin-top: 410px;
            margin-left: -750px;
            white-space: nowrap;
        }

        .features ul {
            margin-top: 600px;
            margin-left: -840px;
            display: flex;
            justify-content: center;
            gap: 150px;
            list-style: none;
            font-family: "Mazzard L light";
            font-size: 18px;
            align-items: center;
        }

        .features ul li {
            color: #F5691E;
            text-decoration: none;
        }

        .about_company {
            background: #E6E6E6;
            text-align: center;
            line-height: 5;
        }

        .about_company h2 {
            font-family: "Mazzard H semibold";
            font-size: 43px;
            color: black;
        }

        .about_company p {
            font-family: "Mazzard H regular";
            font-size: 19px;
            color: black;
        }

        .specials {
            background: white !important;
            width: 100%;
            padding: 80px 0;
            text-align: center;
            position: relative;
            left: 0;
            top: 0;
            right: 0;
        }
        
        .specials::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            right: 50%;
            margin-left: -50vw;
            margin-right: -50vw;
            width: 100vw;
            height: 100%;
            background: white;
            z-index: -1;
        }

        .specials h2 {
            color: #F5691E;
            font-family: "Mazzard H semibold";
            font-size: 43px;
            margin-bottom: 20px;
        }

        .specials p {
            color: black;
            font-family: "Mazzard H semibold";
            font-size: 32px;
            margin-bottom: 60px;
        }

        img#animal {
            height: 290px;
            display: flex;
            flex-direction: flex-start;
            position: absolute;
            margin-left: 150px;
            margin-top: 100px;
        }

        .form-fields {
            max-width: 500px;
            margin: 0 auto  ;
        }

        .form-group {
            position: relative;
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            border: none;
            border-bottom: 2px solid #E6E6E6;
            background: #E6E6E6;
            font-family: "Mazzard L light";
            font-size: 24px;
            color: black;
            outline: none;
            padding: 15px 0 20px 18px;
        }

        .form-group textarea {
            resize: none;
            min-height: 60px;
        }

        .form-group label {
            position: absolute;
            top: 8px;
            left: 0;
            color: black;
            font-family: "Mazzard L light";
            font-size: 24px;
            pointer-events: none;
            transition: all 0.3s ease;
            margin-left: 15px;
        }

        .form-group input:focus, 
        .form-group textarea:focus {
            border-bottom-color: #F5691E;
        }

        .form-group input:focus + label,
        .form-group textarea:focus + label,
        .form-group textarea:not(:placeholder-shown) + label,
        .form-group input:not(:placeholder-shown) + label {
            opacity: 0;
            visibility: hidden;
            color: rgba(0, 0, 0, 0.445);
        }

        /* Стили для модального окна */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            color: black;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #777;
            z-index: 10;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .close-btn:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            padding: 30px;
        }

        @media (min-width: 768px) {
            .modal-content {
                flex-direction: row;
            }
        }

        .modal-image {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-image img {
            max-width: 100%;
            max-height: 400px;
            border-radius: 8px;
        }

        .modal-details {
            flex: 1;
            padding: 20px;
        }

        .modal-title {
            font-family: "Mazzard H semibold";
            font-size: 28px;
            margin-bottom: 10px;
            color: #333;
        }

        .modal-subtitle {
            font-family: "Mazzard H regular";
            font-size: 16px;
            color: #777;
            margin-bottom: 20px;
            font-style: italic;
        }

        .modal-price {
            font-family: "TT Travels regular";
            font-size: 28px;
            color: #F5691E;
            margin-bottom: 25px;
        }

        .modal-description {
            margin-bottom: 25px;
            line-height: 1.6;
            color: #555;
            font-family: "Mazzard H regular";
            font-size: 16px;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: "Mazzard H semibold";
        }

        .quantity-btn:hover {
            background: #e0e0e0;
        }

        .quantity-input {
            width: 60px;
            height: 40px;
            text-align: center;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            margin: 0 10px;
            font-size: 16px;
            font-weight: 600;
            font-family: "Mazzard H medium";
            -moz-appearance: textfield;
            appearance: textfield;
        }

        .quantity-input::-webkit-outer-spin-button,
        .quantity-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
        }

        .add-to-cart {
            flex: 2;
            padding: 15px;
            background: #F5691E;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            font-family: "Mazzard H semibold";
        }

        .add-to-cart:hover {
            background: #d35918;
        }

        .continue-shopping {
            flex: 1;
            padding: 15px;
            background: transparent;
            color: #777;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            font-family: "Mazzard H medium";
        }

        .continue-shopping:hover {
            background: #f5f5f5;
        }
/*  */
        .contacts {
            position: relative;
            text-align: center;
            padding: 20px;
            min-height: 200px;
        }

        .contact-left {
            position: absolute;
            left: 10%; /* ближе к центру */
            top: 80px;
            text-align: left;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .contact-right {
            position: absolute;
            right: 10%; /* ближе к центру */
            top: 80px;
            display: flex;
            flex-direction: row;
            gap: 15px;
        }

        .contact-right img {
            width: 40px;
            height: 40px;
        }

/*  */
        img#Phone {
            height: 31px;
            width: 31px;
        }

        img#Mail {
            height: 27px;
            width: 31px;
        }

        img#Telegram {
            height: 66px;
            width: 66px;
        }

        img#WK {
            height: 66px;
            width: 66px;;
        }

        footer {
            height: 123px;
            width: 100%;
            background-image: url(/images/general/Bridge.png);
            background-size: none;
            background-repeat: repeat;
            background-position: center;
            border-top: #535353 1px solid;
            position: relative;
            margin: 0 auto;
        }

        body {
            overflow-x: hidden; /* только убираем скролл влево-вправо */
            overflow-y: auto;   /* скролл вверх-вниз работает */
        }


        /* Адаптация под мобилки  /ТЕСТ */

        @media (max-width: 768px) {
            header {
                width: 100%;
                border-radius: 0;
            }
    
            header ul {
                flex-direction: column;
                gap: 15px;
                font-size: 18px;
            }
        }

        @media (max-width: 768px) {
            .hero {
                flex-direction: column;
                text-align: center;
                max-height: none;
            }

            img.clocks, img.logo1, img.logo2 {
                margin: 0 auto;
                height: auto;
                max-width: 90%;
            }

            .hero .p1, .hero .p2 {
                margin: 20px auto;
                width: 90%;
                white-space: normal;
                font-size: 24px;
            }
        }

        @media (max-width: 768px) {
            .modal-content {
                flex-direction: column;
            }
    
            .form-fields {
                padding: 0 15px;
            }
        }

        @media (max-width: 768px) {
            .modal {
                width: 95%;
                margin: 20px;
            }
            
            .modal-content {
                padding: 20px 15px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .add-to-cart, .continue-shopping {
                width: 100%;
            }
        }

/* ===== ЖЕСТКИЙ СБРОС БУРГЕРА ===== */
/* ===== БУРГЕР СЛЕВА ===== */
        .burger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 4px;
            padding: 8px;
            background: transparent;
            border: none;
            z-index: 1001;
            position: absolute;
            left: 20px;
            top: 10px; /* ← САМЫЙ ВЕРХ */
            transform: none;
        }

        .burger span {
            width: 25px;
            height: 2px;
            background: white;
            transition: all 0.3s ease;
            transform-origin: center;
        }

        .burger.active span:nth-child(1) {
            transform: translateY(6px) rotate(45deg);
        }

        .burger.active span:nth-child(2) {
            opacity: 0;
            transform: scale(0);
        }

        .burger.active span:nth-child(3) {
            transform: translateY(-6px) rotate(-45deg);
        }

        /* ===== МОБИЛЬНАЯ ВЕРСИЯ ===== */
        @media (max-width: 768px) {
            /* ХЕДЕР */
            header {
                width: 100% !important;
                height: 60px !important;
                padding: 0 !important;
                position: absolute !important; /* Для абсолютного позиционирования бургера */
            }

            body {
                padding-top: 60px !important;
            }

            /* КОНТЕЙНЕР */
            header .container {
                display: flex !important;
                align-items: center !important;
                padding: 0 20px 0 70px !important; /* ЛЕВЫЙ ОТСТУП ДЛЯ БУРГЕРА */
                width: 100% !important;
                height: 60px !important;
            }

            /* БУРГЕР СЛЕВА - ФИКСИРОВАННАЯ ПОЗИЦИЯ */
            .burger {
                display: flex !important;
                position: absolute !important;
                left: 20px !important;
                top: 15px !important;  /* ← ПОДНИМАЕМ ВВЕРХ */
                transform: none !important; /* ← УБИРАЕМ transform */
                margin: 0 !important;
            }
            
            /* ПРЯЧЕМ ОБЫЧНОЕ МЕНЮ */
            header ul:not(.mobile-active) {
                display: none !important;
            }

            /* МОБИЛЬНОЕ МЕНЮ - ЗАНИМАЕТ ВСЁ ОСТАВШЕЕСЯ МЕСТО */
            header ul.mobile-active {
                display: flex !important;
                flex-direction: row !important;
                align-items: center !important;
                gap: 12px !important;
                flex: 1 !important;
                overflow-x: auto !important;
                white-space: nowrap !important;
                padding: 0 !important;
                position: static !important;
                width: auto !important;
                background: transparent !important;
                height: auto !important;
                margin: 0 !important;
            }

            /* ПУНКТЫ МЕНЮ */
            header ul.mobile-active li a {
                font-size: 13px !important;
                padding: 8px 12px !important;
                white-space: nowrap !important;
                color: white !important;
                text-decoration: none !important;
                display: block !important;
            }

            header ul.mobile-active .cart {
                height: 18px !important;
            }

            /* СКРЫВАЕМ СКРОЛЛБАР */
            header ul.mobile-active::-webkit-scrollbar {
                display: none !important;
            }
        }

        /* ДЕСКТОП - ПРЯЧЕМ БУРГЕР */
        @media (min-width: 769px) {
            .burger {
                display: none !important;
            }
        }

        /* Стили для корзины */
    .cart-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2001;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .cart-modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }
    
    .cart-modal {
        background: white;
        border-radius: 12px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
        transform: translateY(20px);
        transition: transform 0.3s ease;
        color: black;
    }
    
    .cart-modal-overlay.active .cart-modal {
        transform: translateY(0);
    }
    
    .cart-content {
        padding: 30px;
    }
    
    .cart-title {
        font-family: "Mazzard H semibold";
        font-size: 28px;
        margin-bottom: 25px;
        text-align: center;
        color: #333;
    }
    
    .cart-item {
        display: flex;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid #eee;
        gap: 15px;
    }
    
    .cart-item-image {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 8px;
    }
    
    .cart-item-details {
        flex: 1;
    }
    
    .cart-item-name {
        font-family: "Mazzard H medium";
        font-size: 16px;
        margin-bottom: 5px;
        color: #333;
    }
    
    .cart-item-price {
        font-family: "TT Travels regular";
        font-size: 16px;
        color: #F5691E;
    }
    
    .cart-item-controls {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .cart-item-quantity {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .quantity-btn-small {
        width: 30px;
        height: 30px;
        background: #f0f0f0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Mazzard H semibold";
        font-size: 14px;
    }
    
    .quantity-btn-small:hover {
        background: #e0e0e0;
    }
    
    .quantity-input-small {
        width: 40px;
        height: 30px;
        text-align: center;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        font-size: 14px;
        font-family: "Mazzard H medium";
        -moz-appearance: textfield;
        appearance: textfield;
    }

    .quantity-input-small::-webkit-outer-spin-button,
    .quantity-input-small::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    
    .remove-item {
        background: none;
        border: none;
        color: #ff4444;
        cursor: pointer;
        font-size: 18px;
        padding: 5px;
        margin-left: 10px;
    }
    
    .remove-item:hover {
        color: #cc0000;
    }
    
    .cart-total {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 2px solid #eee;
    }
    
    .total-line {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: "Mazzard H semibold";
        font-size: 20px;
        color: #333;
    }
    
    .cart-actions {
        margin-top: 25px;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    
    .checkout-btn {
        padding: 15px;
        background: #F5691E;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        font-family: "Mazzard H semibold";
    }
    
    .checkout-btn:hover {
        background: #d35918;
    }
    
    .empty-cart {
        text-align: center;
        padding: 40px 0;
        color: #777;
        font-family: "Mazzard H regular";
        font-size: 18px;
    }

/* Добавлю в стили Beta1.1.html */


/* Стили для формы заказа */
    #orderForm {
        padding: 20px 0;
    }

    #orderForm .form-group {
        margin-bottom: 20px;
        position: relative;
    }

    #orderForm input,
    #orderForm textarea {
        width: 100%;
        border: none;
        border-bottom: 2px solid #E6E6E6;
        background: #E6E6E6;
        font-family: "Mazzard L light";
        font-size: 18px;
        color: black;
        outline: none;
        padding: 12px 0 15px 15px;
        transition: border-color 0.3s ease;
    }

    #orderForm textarea {
        resize: none;
        min-height: 60px;
    }

    #orderForm label {
        position: absolute;
        top: 8px;
        left: 0;
        color: black;
        font-family: "Mazzard L light";
        font-size: 18px;
        pointer-events: none;
        transition: all 0.3s ease;
        margin-left: 15px;
    }

    #orderForm input:focus,
    #orderForm textarea:focus {
        border-bottom-color: #F5691E;
    }

    #orderForm input:focus + label,
    #orderForm textarea:focus + label,
    #orderForm textarea:not(:placeholder-shown) + label,
    #orderForm input:not(:placeholder-shown) + label {
        opacity: 0;
        visibility: hidden;
    }

    #orderForm .modal-actions {
        display: flex;
        gap: 15px;
        margin-top: 25px;
    }

    .order-summary {
        background: #f5f5f5;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        font-family: "Mazzard H regular";
    }

    .order-summary h4 {
        margin-bottom: 10px;
        color: #333;
    }


/* Стили для кнопки в корзине */
    .view-orders-btn {
        padding: 15px;
        background: transparent;
        color: #777;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        font-family: "Mazzard H medium";
        margin-bottom: 10px;
    }
    
    .view-orders-btn:hover {
        background: #f5f5f5;
    }
    
    /* Стили для списка заказов */
    .orders-list {
        max-height: 400px;
        overflow-y: auto;
    }
    
    .order-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        background: #f9f9f9;
    }
    
    .order-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        flex-wrap: wrap;
        gap: 10px;
    }
    
    .order-number {
        font-family: "Mazzard H semibold";
        font-size: 16px;
        color: #333;
    }
    
    .order-date {
        font-family: "Mazzard H regular";
        font-size: 14px;
        color: #777;
    }
    
    .order-status {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-family: "Mazzard H medium";
    }
    
    .status-pending {
        background: #fff3cd;
        color: #856404;
    }
    
    .status-completed {
        background: #d1edff;
        color: #0c5460;
    }
    
    .status-delivered {
        background: #d4edda;
        color: #155724;
    }
    
    .order-total {
        font-family: "Mazzard H semibold";
        font-size: 16px;
        color: #F5691E;
        margin-bottom: 10px;
    }
    
    .order-details-btn {
        padding: 8px 15px;
        background: transparent;
        color: #777;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        font-family: "Mazzard H medium";
    }
    
    .order-details-btn:hover {
        background: #f0f0f0;
    }
    
    .phone-input-section {
        margin-bottom: 25px;
    }
    
    .empty-orders {
        text-align: center;
        padding: 40px 0;
        color: #777;
        font-family: "Mazzard H regular";
        font-size: 18px;
    }

    /* Адаптив для модалки заказа */
    @media (max-width: 768px) {
        #orderForm .modal-actions {
            flex-direction: column;
        }

        #orderForm input,
        #orderForm textarea {
            font-size: 16px;
            padding: 10px 0 12px 12px;
        }

        #orderForm label {
            font-size: 16px;
        }
    }




    
    /* Адаптивность корзины */
    @media (max-width: 768px) {
        .cart-item {
            flex-direction: column;
            text-align: center;
            gap: 10px;
        }
        
        .cart-item-controls {
            justify-content: center;
        }
    }


    </style>
</head>
<body>
<!-- !!!!!!!!!! -->
    <!-- ОБНОВЛЕННЫЙ ХЕДЕР (БУРГЕР) -->
    <header>
        <div class="container" id="container">
            <nav>
                <ul id="navMenu">
                    <li><a href="">О НАС</a></li>
                    <li><a href="">КАТАЛОГ</a></li>
                    <li><a href="">ДОСТАВКА И ОПЛАТА</a></li>
                    <li><a href="">КОНТАКТЫ</a></li>
                    <li><a href="#" class="cart-link"><img src="/images/general/Cart.png" alt="Корзина" class="cart"></a></li>
                </ul>
                <div class="burger" id="burger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
</header>
<!-- !!!!!!!! -->
    <main>
        <section class="hero">
            <img src="/images/general/Clocks.png" alt="Часы" class="clocks">
            <img src="/images/general/Krasnoyarsk.png" alt="Лого" class="logo1">
            <img src="/images/general/teplyee_chem_ti_dumaesh.png" alt="Лого" class="logo2">
            
            <h2 class="p1">ОРИГИНАЛЬНАЯ СУВЕНИРНАЯ ПРОДУКЦИЯ</h2>
            <h2 class="p2">ИЗ СИБИРИ ДЛЯ ПОДАРКОВ И МЕРОПРИЯТИЙ</h2>

            <div class="features">
                <ul>
                    <li class="feature">УНИКАЛЬНЫЙ ДИЗАЙН</li>
                    <li class="feature">БЫСТРАЯ ДОСТАВКА</li>
                    <li class="feature">ВЫГОДНЫЕ ЦЕНЫ</li>
                </ul>
            </div>
        </section>

        <section class="catalog">
            <h2>КАТАЛОГ</h2>
            <div class="product-grid">
                <div class="product" data-product-id="1">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">1 299 ₽</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="2">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="3">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="4">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>
            </div>

            <div class="product-grid">
                <div class="product" data-product-id="5">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="6">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="7">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>

                <div class="product" data-product-id="8">
                    <div class="product-images">
                        <img src="/images/products/notebook-top.png" alt="Продукт">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>Название</p>
                        <p>Название Название</p>
                        <p id="price">Цена</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                </div>
            </div>
        </section>

        <section class="about_company">
            <h2>О КОМПАНИИ</h2>
            <p>Небольшой текст о компании</p>
        </section>

        <section class="specials">
            <div class="container">
                <h2>НУЖНО ЧТО-ТО ОСОБЕННОЕ?</h2>
                <p>Изготовим для вас сувениры по индивидуальному дизайну</p>

                <img src="/images/general/animal.png" alt="Фото" id="animal">

                <form class="form-fields">
                    <div class="form-group">
                        <input type="text" id="name" required placeholder="">
                        <label for="name">Имя</label>
                    </div>

                    <div class="form-group">
                        <input type="tel" id="phone" required placeholder="">
                        <label for="phone">Телефон</label>
                    </div>

                    <div class="form-group">
                        <textarea id="comment" rows="3" placeholder=""></textarea>
                        <label for="comment">Комментарий</label>
                    </div>

                    <button type="submit" class="cta-button">ОСТАВИТЬ ЗАЯВКУ</button>

                </form>
            </div>
        </section>

        <section class="contacts">
            <h2>КОНТАКТЫ</h2>
    
            <div class="contact-left">
                <div class="contact-item">
                    <img src="/images/general/phone.png" alt="Телефон" id="Phone">
                    <p>8-000-000-00-00</p>
                </div>
                <div class="contact-item">
                    <img src="/images/general/Mail.png" alt="Почта" id="Mail">
                    <p>xxxxx@mail.ru</p>
                </div>
            </div>

            <div class="contact-right">
                <img src="/images/general/Telegram.png" alt="Telegram" id="Telegram">
                <img src="/images/general/WK.png" alt="Wk" id="WK">
            </div>
        </section>
    </main>

    <footer>
        <span></span>
    </footer>

    <!-- Модальное окно товара -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <button class="close-btn" id="closeModal">&times;</button>
            <div class="modal-content">
                <div class="modal-image">
                    <img src="/images/products/notebook-top.png" alt="." id="modalImage">
                </div>
                <div class="modal-details">
                    <h2 class="modal-title" id="modalTitle">КРЕПОЛЕСК</h2>
                    <div class="modal-subtitle" id="modalSubtitle">НАЗВАНИЕ НА ЗАГРАДКИ</div>
                    <div class="modal-price" id="modalPrice">1 299 ₽</div>
                    
                    <div class="modal-description" id="modalDescription">
                        <p>Этот уникальный продукт сочетает в себе инновационные технологии и натуральные компоненты для максимального комфорта и эффективности.</p>
                        <p>создан с использованием передовых материалов, которые обеспечивают превосходные теплоизоляционные свойства и долговечность.</p>
                        <p>Идеально подходит для активного отдыха, повседневного использования и особых случаев.</p>
                    </div>
                    
                    <div class="quantity-selector">
                        <button class="quantity-btn" id="decreaseQty">-</button>
                        <input type="number" class="quantity-input" id="quantityInput" value="1" min="1" onfocus="this.select()" autocomplete="off">
                        <button class="quantity-btn" id="increaseQty">+</button>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="add-to-cart" id="addToCart">ДОБАВИТЬ В КОРЗИНУ</button>
                        <button class="continue-shopping" id="continueShopping">ЗАКРЫТЬ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно корзины -->
    
    <div class="cart-modal-overlay" id="cartModalOverlay">
        <div class="cart-modal">
            <button class="close-btn" id="closeCartModal">&times;</button>
            <div class="cart-content">
                <h2 class="cart-title">КОРЗИНА</h2>

                <div class="cart-items" id="cartItems">
                    <!-- Товары будут добавляться сюда -->
                    <div class="empty-cart" id="emptyCart">
                        <p>Корзина пуста</p>
                    </div>
                </div>

                <div class="cart-total" id="cartTotal" style="display: none;">
                    <div class="total-line">
                        <span>Итого:</span>
                        <span id="totalAmount">0 ₽</span>
                    </div>
                </div>

                <div class="cart-actions" id="cartActions" style="display: none;">
                    <button class="checkout-btn" id="checkoutBtn">ОФОРМИТЬ ЗАКАЗ</button>
                    <button class="view-orders-btn" id="viewOrdersBtn">МОИ ЗАКАЗЫ</button>
                    <button class="continue-shopping" id="continueCartShopping">ПРОДОЛЖИТЬ ПОКУПКИ</button>
                </div>
            </div>
        </div>
    </div>



<!-- Модальное окно оформления заказа -->
    <div class="modal-overlay" id="orderModalOverlay">
        <div class="modal" style="max-width: 500px;">
            <button class="close-btn" id="closeOrderModal">&times;</button>
            <div class="modal-content">
                <h2 class="modal-title">ОФОРМЛЕНИЕ ЗАКАЗА</h2>

                <form id="orderForm">
                    <div class="form-group">
                        <input type="text" id="customerName" required placeholder="">
                        <label for="customerName">Имя *</label>
                    </div>

                    <div class="form-group">
                        <input type="tel" id="customerPhone" required placeholder="" pattern="[\+\-\d\s\(\)]{7,15}">
                        <label for="customerPhone">Телефон *</label>
                    </div>

                    <div class="form-group">
                        <input type="email" id="customerEmail" required placeholder="">
                        <label for="customerEmail">Email *</label>
                    </div>

                    <div class="form-group">
                        <textarea id="orderComment" rows="2" placeholder=""></textarea>
                        <label for="orderComment">Комментарий к заказу</label>
                    </div>

                    <div class="order-summary" id="orderSummary" style="background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <h4 style="margin-bottom: 10px;">Ваш заказ:</h4>
                        <div id="orderItemsList"></div>
                        <div style="font-weight: bold; margin-top: 10px; border-top: 1px solid #ddd; padding-top: 10px;">
                            Итого: <span id="orderTotalAmount">0</span> ₽
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="submit" class="add-to-cart">ПОДТВЕРДИТЬ ЗАКАЗ</button>
                        <button type="button" class="continue-shopping" id="cancelOrder">ОТМЕНА</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    
<!-- Новая модалка для истории заказов -->
    <div class="modal-overlay" id="ordersModalOverlay">
        <div class="modal">
            <button class="close-btn" id="closeOrdersModal">&times;</button>
            <div class="modal-content">
                <h2 class="modal-title">МОИ ЗАКАЗЫ</h2>
                
                <!-- Форма для ввода телефона -->
                <div class="phone-input-section" id="phoneInputSection">
                    <div class="form-group">
                        <input type="tel" id="orderPhone" required placeholder="" pattern="[\+\-\d\s\(\)]{7,15}">
                        <label for="orderPhone">Введите ваш телефон *</label>
                    </div>
                    <button class="cta-button" id="loadOrdersBtn">ПОСМОТРЕТЬ ЗАКАЗЫ</button>
                </div>
            
                <!-- Список заказов -->
                <div class="orders-list" id="ordersList" style="display: none;">
                    <div class="order-item">
                        <div class="order-header">
                            <span class="order-number">Заказ #12345</span>
                            <span class="order-date">15.12.2023</span>
                            <span class="order-status status-pending">В обработке</span>
                        </div>
                        <div class="order-total">Сумма: 5 297 ₽</div>
                        <button class="order-details-btn">Подробнее</button>
                    </div>
                    <!-- Заказы будут добавляться динамически -->
                </div>
            
                <!-- Сообщение если заказов нет -->
                <div class="empty-orders" id="emptyOrders" style="display: none;">
                    <p>У вас еще нет заказов</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ДЕБАГ - проверка элементов
        console.log('Корзина в localStorage:', localStorage.getItem('cart'));
        console.log('Элемент cartModalOverlay:', document.getElementById('cartModalOverlay'));
        console.log('Обработчик корзины установлен?', !!document.querySelector('header .cart'));

// Проверка функции openCartModal
        window.testCart = function() {
            console.log('Тест: открытие корзины');
            openCartModal();
        }


        

// ===== ОСНОВНАЯ ИНИЦИАЛИЗАЦИЯ =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM загружен, инициализируем приложение...');
            
            // Инициализируем все системы
            initProductSystem();
            initCartSystem();
            initBurgerMenu();
            initOrderSystem();
            initOrdersSystem();
            initOrdersModal();
            
            // Обновляем отображение корзины
            updateCartDisplay();
        });
        
        let currentProductId = null;
        const modalOverlay = document.getElementById('modalOverlay');
        // ===== СИСТЕМА ТОВАРОВ =====
        function initProductSystem() {
            if (window.productSystemInitialized) {
                return;
            }
            window.productSystemInitialized = true;

            console.log('Инициализируем систему товаров...');
            
            // Получаем элементы после загрузки DOM
            
            const closeModal = document.getElementById('closeModal');
            const decreaseQty = document.getElementById('decreaseQty');
            const increaseQty = document.getElementById('increaseQty');
            const quantityInput = document.getElementById('quantityInput');
            const addToCart = document.getElementById('addToCart');
            const continueShopping = document.getElementById('continueShopping');
            const showMoreButtons = document.querySelectorAll('.show-more');
            const cartButtons = document.querySelectorAll('.cart-wrapper');
        
            // Проверяем что все элементы найдены
            if (!modalOverlay || !closeModal || !decreaseQty || !increaseQty || !quantityInput || !addToCart || !continueShopping) {
                console.error('Не все элементы модального окна найдены');
                return;
            }
        
            // Открытие модального окна при клике на кнопку "ПОДРОБНЕЕ"
            showMoreButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const product = button.closest('.product');
                    const productId = product.getAttribute('data-product-id');
                    openProductModal(productId);
                });
            });
        
            // Открытие модального окна при клике на иконку корзины
            cartButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const product = button.closest('.product');
                    const productId = product.getAttribute('data-product-id');
                    openProductModal(productId);
                });
            });
        
            // Закрытие модального окна
            closeModal.addEventListener('click', closeModalFunc);
            continueShopping.addEventListener('click', closeModalFunc);
        
            // Закрытие при клике вне модального окна
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    closeModalFunc();
                }
            });
        
            // Управление количеством товара
            decreaseQty.addEventListener('click', (e) => {
                e.stopPropagation();
                let currentValue = parseInt(quantityInput.value);
                if (currentValue > 1) {
                    quantityInput.value = currentValue - 1;
                }
            });
        
            increaseQty.addEventListener('click', (e) => {
                e.stopPropagation();
                let currentValue = parseInt(quantityInput.value);
                const maxQuantity = parseInt(quantityInput.getAttribute('data-max')) || 99;

                if (currentValue < maxQuantity) {
                    quantityInput.value = currentValue + 1;
                } else {
                    showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                }
            });
        
            // Валидация ввода количества
            quantityInput.addEventListener('change', () => {
                let value = parseInt(quantityInput.value);
                const maxQuantity = parseInt(quantityInput.getAttribute('data-max')) || 99;

                if (isNaN(value) || value < 1) {
                    quantityInput.value = 1;
                } else if (value > maxQuantity) {
                    quantityInput.value = maxQuantity;
                    showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                }
            });
        
            // Добавление в корзину

            const addToCartBtn = document.getElementById('addToCart');
            if (addToCartBtn && !addToCartBtn._listenerAdded) {
                addToCartBtn.addEventListener('click', function() {
                    if (!currentProductId) return;
                    const quantity = parseInt(document.getElementById('quantityInput').value);
                    addToCartFunc(currentProductId, quantity);
                    closeModalFunc();
                });
                addToCartBtn._listenerAdded = true;
            }

            updateCartDisplay();
        
            // Закрытие по Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modalOverlay.classList.contains('active')) {
                    closeModalFunc();
                }
            });
        
            console.log('Система товаров инициализирована');
        }
        
        function formatPrice(price) {
            return new Intl.NumberFormat('ru-RU').format(price);
        }


        const products = {
            "1": {
                title: "Сибирский блокнот",
                subtitle: "С видами Красноярска", 
                price: 1299,
                description: "Премиальный блокнот с уникальными иллюстрациями достопримечательностей Красноярска. Идеален для записей и в качестве подарка.",
                image: "/images/products/notebook-top.png"
            },
            "2": {
                title: "Часы 'Енисей'",
                subtitle: "Деревянные настенные",
                price: 4599,
                description: "Настенные часы из натуральной сибирской березы с гравировкой карты Енисея. Диаметр 40 см.",
                image: "/images/products/clock.png"
            },
            "3": {
                title: "Кружка 'Столбы'",
                subtitle: "Керамическая 350 мл",
                price: 899,
                description: "Термостойкая керамическая кружка с изображением знаменитых Красноярских столбов. Сохраняет тепло до 2 часов.",
                image: "/images/products/mug.png"
            },
            "4": {
                title: "Футболка 'Красноярск'",
                subtitle: "Хлопок 100%",
                price: 1899,
                description: "Мужская футболка из 100% хлопка с принтом панорамы Красноярска. Размеры: S-XXL.",
                image: "/images/products/tshirt.png"
            },
            "5": {
                title: "Брелок 'Роев ручей'",
                subtitle: "Металлический",
                price: 499,
                description: "Качественный металлический брелок с логотипом красноярского зоопарка 'Роев ручей'. Идеальный сувенир.",
                image: "/images/products/keychain.png"
            },
            "6": {
                title: "Шарф 'Сибирь'",
                subtitle: "Шерсть 80%",
                price: 2399,
                description: "Теплый шерстяной шарф с традиционным сибирским орнаментом. Длина 180 см, ширина 30 см.",
                image: "/images/products/scarf.png"
            },
            "7": {
                title: "Чай 'Таёжный'",
                subtitle: "Травяной сбор 100г",
                price: 699,
                description: "Ароматный травяной сбор из сибирских трав: иван-чай, чабрец, зверобой, мята. Натуральный продукт.",
                image: "/images/products/tea.png"
            },
            "8": {
                title: "Открытки 'Красноярск'",
                subtitle: "Набор из 6 штук",
                price: 399,
                description: "Набор качественных открыток с фотографиями Красноярска в разные времена года. Размер 10х15 см.",
                image: "/images/products/postcards.png"
            }
        };


        async function loadProductsFromApi() {
            try {
                console.log(`Загружаем товары из API...`);
                const response = await fetch(`http://localhost:3000/api/products`);
                console.log('Ответ получен, статус:', response.status)

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const productsFromApi = await response.json();
                console.log(`Товары загружены:`, productsFromApi);

                const sortedProducts = productsFromApi.sort((a, b) => a.id - b.id);

                //Заменяем статические данные на данные из API
                window.products = {};
                productsFromApi.forEach(product => {
                    window.products[product.id] = {
                        id: product.id,
                        title: product.name,
                        subtitle: 'Сибирские сувениры',
                        price: parseFloat(product.price),
                        description: product.description || 'Качественный сибирский Сувенир',
                        image: product.image_url,
                        stock: product.stock || 99
                    };
                });

                console.log('window.products создан:', window.products);
                updateProductGrid(productsFromApi);
            } catch (error) {
                console.error('Ошибка загрузки товаров:', error);
                //Если API не доступно - испольщуем статические данные
                console.log('Используем статические данные');
            }
        }

        async function getProductInfo(productId) {
            try {
                const response = await fetch(`/api/products/${productId}`);
                if (response.ok) {
                    const product = await response.json();
                    return product;
                }
                return null;
            } catch (error) {
                console.error('Ошибка получения информации о товаре:', error);
                return null;
            }
        }




        function updateProductGrid(products) {
            const productGrids = document.querySelectorAll('.product-grid');

            productGrids.forEach(grid => {
                grid.innerHTML = '';
            });

            
            
                // Создаем карточки товаров динамически
            products.forEach((product, index) => {
                const productElement = document.createElement('div');
                productElement.className = 'product';
                productElement.setAttribute('data-product-id', product.id); // ← используем реальный ID из БД
                productElement.innerHTML = `
                    <div class="product-images">
                        <img src="${product.image_url || '/images/products/notebook-top.png'}" alt="${product.name}">
                        <div class="cart-wrapper"><img src="/images/general/Cart.png" alt="Корзина" id="cart"></div>
                    </div>
                    <div class="product-info">
                        <p>${product.name}</p>
                        <p>${product.description ? product.description.substring(0, 30) + '...' : 'Сибирский сувенир'}</p>
                        <p id="price">${parseFloat(product.price).toLocaleString('ru-RU')} ₽</p>
                    </div>
                    <button class="show-more">ПОДРОБНЕЕ</button>
                `;
                
                // Добавляем в первый доступный grid
                if (productGrids[0] && index < 8) {
                    productGrids[0].appendChild(productElement);
                } else if (productGrids[1]) {
                    productGrids[1].appendChild(productElement);
                }
            });
            
                // Переинициализируем обработчики для новых элементов
            reinitProductHandlers();    
        }

        function reinitProductHandlers() {
            // Обновляем обработчики для кнопок "ПОДРОБНЕЕ"
            const showMoreButtons = document.querySelectorAll('.show-more');
            showMoreButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const product = button.closest('.product');
                    const productId = product.getAttribute('data-product-id');
                    openProductModal(productId);
                });
            });
        
            // Обновляем обработчики для иконок корзины
            const cartButtons = document.querySelectorAll('.cart-wrapper');
            cartButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const product = button.closest('.product');
                    const productId = product.getAttribute('data-product-id');
                    openProductModal(productId);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM загружен, инициализируем приложение...');

            loadProductsFromApi();

            initProductSystem();
            initCartSystem();
            initBurgerMenu();

            updateCartDisplay();
        });



        // Функция открытия модального окна товара
        async function openProductModal(productId) {
            const product = Object.values(window.products).find(p => p.id == productId);
            if (!product) {
                console.error('Товар не найден:', productId);
                console.log('Доступные товары:', window.products);
                return;
            }
        
            currentProductId = productId;
        
            // Загружаем актуальную информацию о товаре из БД
            const productInfo = await getProductInfo(productId);
            const maxQuantity = productInfo?.stock || 99;
        
            document.getElementById('modalTitle').textContent = product.title;
            document.getElementById('modalSubtitle').textContent = product.subtitle;
            document.getElementById('modalPrice').textContent = `${formatPrice(product.price)} ₽`;
            document.getElementById('modalDescription').innerHTML = `<p>${product.description}</p>`;
            document.getElementById('modalImage').src = product.image;
        
            document.getElementById('quantityInput').value = 1;
            document.getElementById('quantityInput').setAttribute('data-max', maxQuantity);
        
            modalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Функция закрытия модального окна товара
        function closeModalFunc() {
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // Функция добавления в корзину
        async function addToCartFunc(productId, quantity) {
            const product = Object.values(window.products).find(p => p.id == productId);
            if (!product) {
                console.error('Товар не найден для добавления в корзину:', productId);
                showNotification('Ошибка: товар не найден');
                return;
            }
        
            if (quantity < 1) {
                console.error('Количество должно быть больше 0');
                return;
            }

            // Проверяем лимит из БД
            const productInfo = await getProductInfo(productId);
            const maxQuantity = productInfo?.stock || 99;

            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItem = cart.find(item => item.id == productId);      
        
            if (existingItem) {
                const newQuantity = existingItem.quantity + quantity;
                if (newQuantity > maxQuantity) {
                    showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                    existingItem.quantity = maxQuantity;
                } else {
                    existingItem.quantity = newQuantity;
                }
            } else {
                if (quantity > maxQuantity) {
                    showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                    quantity = maxQuantity;
                }
                cart.push({
                    id: productId,
                    title: product.title,
                    price: product.price,
                    quantity: quantity,
                    image: product.image,
                    maxQuantity: maxQuantity
                });
            }       
        
            localStorage.setItem('cart', JSON.stringify(cart));
            showNotification(`Товар "${product.title}" добавлен в корзину`);
            updateCartDisplay();
        }
        
        // Функция показа уведомления
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #F5691E;
                color: white;
                padding: 15px 20px;
                border-radius: 6px;
                font-family: "Mazzard H medium";
                z-index: 3000;
            `;
            notification.textContent = message;
        
            document.body.appendChild(notification);
        
            // Удаляем уведомление через 3 секунды
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // ===== БУРГЕР-МЕНЮ =====
        function initBurgerMenu() {
            console.log('Инициализируем бургер-меню...');
            
            const burger = document.getElementById('burger');
            const navMenu = document.getElementById('navMenu');
        
            if (!burger || !navMenu) {
                console.error('Элементы бургер-меню не найдены');
                return;
            }
        
            burger.addEventListener('click', () => {
                navMenu.classList.toggle('mobile-active');
                burger.classList.toggle('active');
                document.body.classList.toggle('menu-open');
            });
        
            // Закрытие при клике на ссылку
            document.querySelectorAll('#navMenu a').forEach(link => {
                link.addEventListener('click', () => {
                    navMenu.classList.remove('mobile-active');
                    burger.classList.remove('active');
                    document.body.classList.remove('menu-open');
                });
            });
        
            // Закрытие при клике вне меню
            document.addEventListener('click', (e) => {
                if (!e.target.closest('nav') && navMenu.classList.contains('mobile-active')) {
                    navMenu.classList.remove('mobile-active');
                    burger.classList.remove('active');
                    document.body.classList.remove('menu-open');
                }
            });
            
            console.log('Бургер-меню инициализировано');
        }
        
        // ===== СИСТЕМА КОРЗИНЫ =====
        
        // Основная функция инициализации корзины
        function initCartSystem() {
            console.log('Инициализируем систему корзины...');
            
            // Настраиваем обработчики событий
            setupCartEventListeners();

            const cartItems = document.getElementById('cartItems');
            if (cartItems && !cartItems._listenersAdded) {
                cartItems.addEventListener('click', handleCartItemClick);
                cartItems.addEventListener('change', handleCartItemChange);
                cartItems._listenersAdded = true;
            }
            
            console.log('Система корзины инициализирована');
        }
        
        // Настройка обработчиков событий корзины
        function setupCartEventListeners() {
            // Обработчик для иконки корзины в хедере
            const headerCartLink = document.querySelector('header .cart')?.closest('a');
            if (headerCartLink) {
                headerCartLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Клик по корзине в хедере');
                    openCartModal();
                });
                console.log('Обработчик корзины в хедере установлен');
            } else {
                console.error('Не найдена ссылка корзины в хедере');
            }
            
            // Обработчики закрытия корзины
            const closeCartModalBtn = document.getElementById('closeCartModal');
            const continueCartShoppingBtn = document.getElementById('continueCartShopping');
            
            if (closeCartModalBtn) {
                closeCartModalBtn.addEventListener('click', closeCartModal);
            }
            if (continueCartShoppingBtn) {
                continueCartShoppingBtn.addEventListener('click', closeCartModal);
            }
            
            // Закрытие корзины при клике вне окна
            const cartModalOverlay = document.getElementById('cartModalOverlay');
            if (cartModalOverlay) {
                cartModalOverlay.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeCartModal();
                    }
                });
            }
            
            // Закрытие по Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('cartModalOverlay')?.classList.contains('active')) {
                    closeCartModal();
                }
            });
            
            // Обработчик оформления заказа
            const checkoutBtn = document.getElementById('checkoutBtn');
            if(checkoutBtn) {
                checkoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    openOrderModal();
                });
            }
        }
        
        // Функция открытия корзины
        function openCartModal() {
            console.log('Открываем корзину...');
            validateCartOnOpen().then(() => {
                updateCartDisplay();
                const cartModalOverlay = document.getElementById('cartModalOverlay');
                if (cartModalOverlay) {
                    cartModalOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            });
        }
        
        // Функция закрытия корзины
        function closeCartModal() {
            console.log('Закрываем корзину...');
            const cartModalOverlay = document.getElementById('cartModalOverlay');
            if (cartModalOverlay) {
                cartModalOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        // Функция обновления отображения корзины
        
// Функция обновления отображения корзины
// Функция обновления отображения корзины
    function updateCartDisplay() {
        console.log('Обновляем отображение корзины...');

        const cartItems = document.getElementById('cartItems');
        const emptyCart = document.getElementById('emptyCart');
        const cartTotal = document.getElementById('cartTotal');
        const cartActions = document.getElementById('cartActions');
        const totalAmount = document.getElementById('totalAmount');

        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        console.log('Товаров в корзине:', cart.length);

        // Удаляем только товары (элементы с классом cart-item), оставляя emptyCart
        const cartItemElements = cartItems.querySelectorAll('.cart-item');
        cartItemElements.forEach(item => item.remove());

        // Если корзина пустая
        if (cart.length === 0) {
            if (emptyCart) emptyCart.style.display = 'block';
            if (cartTotal) cartTotal.style.display = 'none';
            if (cartActions) cartActions.style.display = 'none';
            console.log('Корзина пуста');
            return;
        }

        // Скрываем сообщение "Корзина пуста"
        if (emptyCart) emptyCart.style.display = 'none';
        if (cartTotal) cartTotal.style.display = 'block';
        if (cartActions) cartActions.style.display = 'block';

        let total = 0;

        // Добавляем каждый товар в корзину
        cart.forEach(item => {
            const itemTotal = item.price * item.quantity;
            total += itemTotal;

            const cartItemElement = document.createElement('div');
            cartItemElement.className = 'cart-item';
            cartItemElement.innerHTML = `
                <img src="${item.image}" alt="${item.title}" class="cart-item-image">
                <div class="cart-item-details">
                    <div class="cart-item-name">${item.title}</div>
                    <div class="cart-item-price">${item.price} ₽</div>
                </div>
                <div class="cart-item-controls">
                    <div class="cart-item-quantity">
                        <button class="quantity-btn-small decrease-cart" data-id="${item.id}">-</button>
                        <input type="number" class="quantity-input-small" value="${item.quantity}" min="1"  data-id="${item.id}" onclick="this.select()" autocomplete="off">
                        <button class="quantity-btn-small increase-cart" data-id="${item.id}">+</button>
                    </div>
                    <button class="remove-item" data-id="${item.id}">&times;</button>
                </div>
            `;
            
            cartItems.appendChild(cartItemElement);
        });


        // Обновляем общую сумму
        if (totalAmount) totalAmount.textContent = `${total} ₽`;

        // Добавляем обработчики событий для динамических элементов

        console.log('Корзина обновлена, итого:', total + ' ₽');
    }




        
        // Обработчики событий для товаров в корзине

// Обработчики событий для товаров в корзине
        function addCartItemEventListeners() {
            const cartItems = document.getElementById('cartItems');
            if (!cartItems) return;
        }
        
        // Обработчик кликов
        async function handleCartItemClick(e) {
            const target = e.target;
            const productId = target.getAttribute('data-id');

            if (!productId) return;

            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const itemIndex = cart.findIndex(item => item.id == productId);

            if (itemIndex === -1) return;
        
            // Получаем информацию о лимите из БД
            const productInfo = await getProductInfo(productId);
            const maxQuantity = productInfo?.stock || 99;
        
            // Увеличение количества
            if (target.classList.contains('increase-cart')) {
                if (cart[itemIndex].quantity < maxQuantity) {
                    cart[itemIndex].quantity++;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartDisplay();
                } else {
                    showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                }
            }
            // Уменьшение количества
            else if (target.classList.contains('decrease-cart')) {
                if (cart[itemIndex].quantity > 1) {
                    cart[itemIndex].quantity--;
                } else {
                    cart.splice(itemIndex, 1);
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            }
            // Удаление товара
            else if (target.classList.contains('remove-item')) {
                cart.splice(itemIndex, 1);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            }
        }

        // Обработчик изменений в input корзины
        async function handleCartItemChange(e) {
            if (e.target.classList.contains('quantity-input-small')) {
                const productId = e.target.getAttribute('data-id');
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                const item = cart.find(item => item.id == productId);

                if (item) {
                    // Получаем информацию о лимите из БД
                    const productInfo = await getProductInfo(productId);
                    const maxQuantity = productInfo?.stock || 99;
                
                    let value = parseInt(e.target.value);
                
                    if (isNaN(value) || value < 1) value = 1;
                    if (value > maxQuantity) {
                        value = maxQuantity;
                        showNotification(`Максимальное количество: ${maxQuantity} шт.`);
                    }

                    item.quantity = value;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartDisplay();
                }
            }
        }

        // Асинхронная проверка остатков
        async function checkStockLimit(productId, requestedQuantity) {
            try {
                const productInfo = await getProductInfo(productId);

                if (productInfo && productInfo.stock !== undefined) {
                    if (requestedQuantity > productInfo.stock) {
                        let cart = JSON.parse(localStorage.getItem('cart')) || [];
                        const item = cart.find(item => item.id == productId);

                        if (item && item.quantity > productInfo.stock) {
                            item.quantity = productInfo.stock;
                            localStorage.setItem('cart', JSON.stringify(cart));
                            updateCartDisplay();
                            showNotification(`Максимальное количество: ${productInfo.stock} шт.`)
                        }
                    }
                }
            } catch (error) {
                console.error('Ошибка проверки остатков:', error);
            }
        }

        async function validateCartOnOpen() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            let cartUpdated = false;
        
            for (let item of cart) {
                const productInfo = await getProductInfo(item.id);
                if (productInfo && productInfo.stock !== undefined) {

                    item.maxQuantity = productInfo.stock;

                    if (item.quantity > productInfo.stock) {
                        item.quantity = productInfo.stock;
                        cartUpdated = true;
                        showNotification(`Количество "${item.title}" уменьшено до ${productInfo.stock} шт. (максимум в наличии)`);
                    }
                }
            }
        
            if (cartUpdated) {
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            }
        }



// ===== СИСТЕМА ОФОРМЛЕНИЯ ЗАКАЗА =====

        function initOrderSystem() {
            console.log('Инициализируем систему заказов...');

            const orderModal = document.getElementById('orderModalOverlay');
            const closeOrderBtn = document.getElementById('closeOrderModal');
            const cancelOrderBtn = document.getElementById('cancelOrder');
            const orderForm = document.getElementById('orderForm');
            const checkoutBtn = document.getElementById('checkoutBtn');
        
            if (!orderModal || !checkoutBtn) {
                console.error('Не найдены элементы системы заказов');
                return;
            }

        
            // Открытие модалки оформления заказа
            checkoutBtn.addEventListener('click', function(e) {
                e.preventDefault();
                openOrderModal();
            });
        
            // Закрытие модалки
            closeOrderBtn.addEventListener('click', closeOrderModal);
            cancelOrderBtn.addEventListener('click', closeOrderModal);
        
            // Закрытие при клике вне модалки
            orderModal.addEventListener('click', function(e) {
                if (e.target === orderModal) {
                    closeOrderModal();
                }
            });
        
            // Отправка формы заказа
            orderForm.addEventListener('submit', function(e) {
                e.preventDefault();
                submitOrder();
            });
        
            // Закрытие по Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && orderModal.classList.contains('active')) {
                    closeOrderModal();
                }
            });
        }

        function openOrderModal() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];

            if (cart.length === 0) {
                showNotification('Корзина пуста!');
                return;
            }
        
            // Обновляем сводку заказа
            updateOrderSummary(cart);
        
            const orderModal = document.getElementById('orderModalOverlay');
            orderModal.classList.add('active');

            closeCartModal();

            document.body.style.overflow = 'hidden';
        }

        function updateOrderSummary(cart) {
            const itemsList = document.getElementById('orderItemsList');
            const totalAmount = document.getElementById('orderTotalAmount');

            let total = 0;
            let itemsHTML = '';

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                itemsHTML += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 14px;">
                        <span>${item.title} × ${item.quantity}</span>
                        <span>${itemTotal} ₽</span>
                    </div>
                `;
            });

            itemsList.innerHTML = itemsHTML;
            totalAmount.textContent = total;
        }

        function closeOrderModal() {
            const orderModal = document.getElementById('orderModalOverlay');
            orderModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        async function submitOrder() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];

            if (cart.length === 0) {
                showNotification('Корзина пуста!');
                return;
            }
        
            // Собираем данные формы
            const orderData = {
                customer_name: document.getElementById('customerName').value.trim(),
                customer_phone: document.getElementById('customerPhone').value.trim(),
                customer_email: document.getElementById('customerEmail').value.trim(),
                comment: document.getElementById('orderComment').value.trim(),
                items: cart.map(item => ({
                    product_id: item.id,
                    quantity: item.quantity
                }))
            };
        
            // Валидация
            if (!orderData.customer_name || !orderData.customer_phone || !orderData.customer_email) {
                showNotification('Заполните все обязательные поля!');
                return;
            }
        
            // Валидация email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(orderData.customer_email)) {
                showNotification('Введите корректный email!');
                return;
            }
        
            // Валидация телефона (минимум 7 цифр)
            const phoneDigits = orderData.customer_phone.replace(/\D/g, '');
            if (phoneDigits.length < 7) {
                showNotification('Введите корректный номер телефона!');
                return;
            }
        
            try {
                // Показываем лоадер
                const submitBtn = document.querySelector('#orderForm .add-to-cart');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'ОФОРМЛЯЕМ...';
                submitBtn.disabled = true;
            
                console.log('Отправляем заказ:', orderData);
            
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });
            
                const result = await response.json();
                console.log('Ответ сервера:', result);
            
                if (response.ok && result.success) {
                    // Успешное оформление
                    showNotification(`✅ Заказ №${result.order_id} оформлен! Сумма: ${result.total_amount} ₽`);

                    // Очищаем корзину
                    localStorage.removeItem('cart');
                    updateCartDisplay();

                    // Закрываем модалки
                    closeOrderModal();
                    closeCartModal();

                    // Очищаем форму
                    document.getElementById('orderForm').reset();
                } else {
                    throw new Error(result.error || 'Ошибка оформления заказа');
                }
            
            } catch (error) {
                console.error('Ошибка оформления заказа:', error);
                showNotification('❌ Ошибка оформления заказа: ' + error.message);
            } finally {
                // Восстанавливаем кнопку
                const submitBtn = document.querySelector('#orderForm .add-to-cart');
                if (submitBtn) {
                    submitBtn.textContent = 'ПОДТВЕРДИТЬ ЗАКАЗ';
                    submitBtn.disabled = false;
                }
            }
        }


// ===== СИСТЕМА ИСТОРИИ ЗАКАЗОВ =====

// Инициализация модалки заказов
        function initOrdersModal() {
            const ordersModal = document.getElementById('ordersModalOverlay');
            const closeOrdersBtn = document.getElementById('closeOrdersModal');
            const loadOrdersBtn = document.getElementById('loadOrdersBtn');
            const viewOrdersBtn = document.getElementById('viewOrdersBtn');

            if (!ordersModal || !closeOrdersBtn || !loadOrdersBtn || !viewOrdersBtn) {
                console.error('Не найдены элементы модалки заказов');
                return;
            }

            // Обработчик для кнопки "Мои заказы" в корзине
            viewOrdersBtn.addEventListener('click', function(e) {
                e.preventDefault();
                openOrdersModal();
            });

            // Закрытие модалки
            closeOrdersBtn.addEventListener('click', closeOrdersModal);

            // Загрузка заказов по телефону
            loadOrdersBtn.addEventListener('click', loadUserOrders);

            // Закрытие при клике вне модалки
            ordersModal.addEventListener('click', function(e) {
                if (e.target === ordersModal) {
                    closeOrdersModal();
                }
            });

            // Закрытие по Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && ordersModal.classList.contains('active')) {
                    closeOrdersModal();
                }
            });

            console.log('Модалка заказов инициализирована');
        }

        // Открытие модалки заказов
        function openOrdersModal() {
            const ordersModal = document.getElementById('ordersModalOverlay');
            if (ordersModal) {
                // Сбрасываем состояние
                document.getElementById('phoneInputSection').style.display = 'block';
                document.getElementById('ordersList').style.display = 'none';
                document.getElementById('emptyOrders').style.display = 'none';

                // Автозаполнение телефона если есть в localStorage
                const lastPhone = localStorage.getItem('lastUsedPhone');
                if (lastPhone) {
                    document.getElementById('orderPhone').value = lastPhone;
                } else {
                    document.getElementById('orderPhone').value = '';
                }

                ordersModal.classList.add('active');
                document.body.style.overflow = 'hidden';

                // Закрываем корзину
                closeCartModal();
            }
        }

        // Закрытие модалки заказов
        function closeOrdersModal() {
            const ordersModal = document.getElementById('ordersModalOverlay');
            if (ordersModal) {
                ordersModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }

        // Загрузка заказов пользователя
        async function loadUserOrders() {
            const phone = document.getElementById('orderPhone').value.trim();
        
            if (!phone) {
                showNotification('Введите номер телефона');
                return;
            }
        
            // Валидация телефона
            const phoneDigits = phone.replace(/\D/g, '');
            if (phoneDigits.length < 7) {
                showNotification('Введите корректный номер телефона');
                return;
            }
        
            try {
                // Сохраняем телефон в localStorage
                localStorage.setItem('lastUsedPhone', phone);

                // Показываем лоадер
                const loadBtn = document.getElementById('loadOrdersBtn');
                const originalText = loadBtn.textContent;
                loadBtn.textContent = 'ЗАГРУЗКА...';
                loadBtn.disabled = true;
            
                console.log('Загружаем заказы для телефона:', phoneDigits);
            
                // Загружаем заказы с сервера
                const response = await fetch(`/api/orders?phone=${encodeURIComponent(phoneDigits)}`);

                console.log('Статус ответа:', response.status);
            
                if (!response.ok) {
                    throw new Error('Ошибка загрузки заказов');
                }
            
                const orders = await response.json();
                console.log('Получены заказы:', orders);
            
                // Обновляем интерфейс
                displayOrders(orders);
            
            } catch (error) {
                console.error('Ошибка загрузки заказов:', error);
                showNotification('Ошибка загрузки заказов: ' + error.message);
            } finally {
                // Восстанавливаем кнопку
                const loadBtn = document.getElementById('loadOrdersBtn');
                if (loadBtn) {
                    loadBtn.textContent = 'ПОСМОТРЕТЬ ЗАКАЗЫ';
                    loadBtn.disabled = false;
                }
            }
        }

        // Отображение списка заказов
        function displayOrders(orders) {
            const phoneInputSection = document.getElementById('phoneInputSection');
            const ordersList = document.getElementById('ordersList');
            const emptyOrders = document.getElementById('emptyOrders');

            phoneInputSection.style.display = 'none';

            if (!orders || orders.length === 0) {
                emptyOrders.style.display = 'block';
                ordersList.style.display = 'none';
                return;
            }

            // Очищаем список
            ordersList.innerHTML = '';

            // Добавляем заказы
            orders.forEach(order => {
                const orderElement = document.createElement('div');
                orderElement.className = 'order-item';
                orderElement.innerHTML = `
                    <div class="order-header">
                        <span class="order-number">Заказ #${order.id}</span>
                        <span class="order-date">${formatOrderDate(order.created_at)}</span>
                        <span class="order-status status-${order.status}">${getStatusText(order.status)}</span>
                    </div>
                    <div class="order-total">Сумма: ${formatPrice(order.total_amount)} ₽</div>
                    <button class="order-details-btn" onclick="showOrderDetails(${order.id})">Подробнее</button>
                `;
                ordersList.appendChild(orderElement);
            });

            ordersList.style.display = 'block';
            emptyOrders.style.display = 'none';
        }

        // Форматирование даты заказа
        function formatOrderDate(dateString) {
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('ru-RU');
            } catch (error) {
                return 'дата не указана';
            }
        }

        // Текст статуса заказа
        function getStatusText(status) {
            const statusMap = {
                'pending': 'В обработке',
                'processing': 'В обработке', 
                'completed': 'Завершен',
                'delivered': 'Доставлен',
                'cancelled': 'Отменен'
            };
            return statusMap[status] || status;
        }

        // Показ деталей заказа
        function showOrderDetails(orderId) {
            // Здесь можно реализовать просмотр деталей заказа
            console.log('Просмотр заказа:', orderId);
            showNotification(`Детали заказа #${orderId} - можно реализовать отдельную модалку`);
        }



        function initOrdersSystem() {
            console.log('Инициализируем систему заказов...');

            const viewOrdersBtn = document.getElementById('viewOrdersBtn');
            if (viewOrdersBtn) {
                viewOrdersBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openOrdersModal();
                });
            }

            // Остальной код для модалки заказов...
            initOrdersModal();
        }


        console.log('Скрипт загружен, ожидаем DOM...');


    </script>
</body>
</html> 